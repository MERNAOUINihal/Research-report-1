<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="MERNAOUI Nihal">

<title>Research part 1 - final</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RESEARCH REP 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="RESEARCH REP 1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="RESEARCH REP 1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="RESEARCH REP 1_files/libs/quarto-html/popper.min.js"></script>
<script src="RESEARCH REP 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RESEARCH REP 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="RESEARCH REP 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RESEARCH REP 1_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RESEARCH REP 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RESEARCH REP 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RESEARCH REP 1_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="RESEARCH REP 1_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="RESEARCH REP 1_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="RESEARCH REP 1_files/libs/viz-1.8.2/viz.js"></script>
<link href="RESEARCH REP 1_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="RESEARCH REP 1_files/libs/grViz-binding-1.0.11/grViz.js"></script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research part 1 - final</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>MERNAOUI Nihal </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the required packages:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(DiagrammeR)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Afro <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MOR_R10.Data_06June24.wtd_.final_.release_updated.13Feb25.csv"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level1">
<h1>Introduction:</h1>
<p>Urban inequality in Morocco remains marked by persistent deficits in infrastructure, public services, and economic security within many urban neighborhoods. In such contexts, households face recurring exposure to material deprivation and insecurity. While these conditions are often framed as policy failures, they also shape how households adapt to constrained environments. Where formal welfare systems provide limited protection, informal support networks, particularly assistance from family, friends, and neighbors, play a central role in coping with risk and uncertainty. As shown by Moser (1998), social networks function as key assets for urban households facing structural vulnerability. Using Afrobarometer Round 10 data, this study examines how material deprivation and neighborhood conditions relate to reliance on informal support and perceived insecurity in urban Morocco.</p>
</section>
<section id="research-question-and-hypotheses" class="level1">
<h1>Research question and hypotheses:</h1>
<p>This study asks the following research question:</p>
<p>“How do material deprivation and neighborhood infrastructure conditions relate to households’ reliance on informal support networks and perceptions of neighborhood insecurity in urban Morocco?”</p>
<p>As such, and based on existing work on urban vulnerability and informal coping mechanisms, the analysis tests two hypotheses:</p>
<p><strong>H1: Economic precarity and informal support.</strong><br>
Households experiencing higher levels of material deprivation are more likely to report receiving assistance from family members and from friends or neighbors.</p>
<p><strong>H2: Infrastructure deficits and insecurity.</strong><br>
Households living in under-serviced neighborhoods report higher levels of perceived neighborhood insecurity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is to visualize the research question, and how the hypothesis emerged. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">digraph conceptual_model {</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">  graph [layout = dot, rankdir = TB]</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">  node [shape = ellipse, style = filled, fillcolor = </span><span class="sc">\"</span><span class="st">#F2F2F2</span><span class="sc">\"</span><span class="st">, fontname = Helvetica]</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="st">  material [label = </span><span class="sc">\"</span><span class="st">Material Deprivation</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">  infra [label = </span><span class="sc">\"</span><span class="st">Neighborhood Infrastructure</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="st">  support [label = </span><span class="sc">\"</span><span class="st">Reliance on Informal Support Networks</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">  insecurity [label = </span><span class="sc">\"</span><span class="st">Perceived Neighborhood Insecurity</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">  material -&gt; support [label = </span><span class="sc">\"</span><span class="st">H1</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">  material -&gt; insecurity</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">  infra -&gt; support</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">  infra -&gt; insecurity [label = </span><span class="sc">\"</span><span class="st">H2</span><span class="sc">\"</span><span class="st">]</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-620a6a0847f144323114" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-620a6a0847f144323114">{"x":{"diagram":"\ndigraph conceptual_model {\n\n  graph [layout = dot, rankdir = TB]\n\n  node [shape = ellipse, style = filled, fillcolor = \"#F2F2F2\", fontname = Helvetica]\n\n  material [label = \"Material Deprivation\"]\n  infra [label = \"Neighborhood Infrastructure\"]\n  support [label = \"Reliance on Informal Support Networks\"]\n  insecurity [label = \"Perceived Neighborhood Insecurity\"]\n\n  material -> support [label = \"H1\"]\n  material -> insecurity\n  infra -> support\n  infra -> insecurity [label = \"H2\"]\n\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Figure 1 summarizes the conceptual framework underlying the research question and the two hypotheses examined in this study.</p>
<section id="data-and-data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-and-data-preparation">Data and Data Preparation</h2>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>This study uses data from Afrobarometer Round 10 (Morocco, 2024), a nationally representative survey of Moroccan adults aged 18 and over. The dataset combines individual-level survey responses with enumerator-observed characteristics of respondents’ enumeration areas, allowing the analysis to link household conditions to neighborhood-level infrastructure and service access.</p>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data preparation</h3>
<p>The Afrobarometer dataset is already structured at the individual respondent level, with one row per respondent and one column per variable. No major data cleaning or reshaping was required. Data preparation consisted of selecting relevant variables, recoding categorical responses into analytically meaningful formats, and constructing descriptive indicators for material deprivation, neighborhood infrastructure, informal support, and perceived insecurity. Responses such as “No further response” were treated as missing values. All preparation steps were conducted in R and are fully reproducible.</p>
</section>
</section>
<section id="variables-and-measures" class="level2">
<h2 class="anchored" data-anchor-id="variables-and-measures">Variables and Measures</h2>
<section id="material-deprivation" class="level3">
<h3 class="anchored" data-anchor-id="material-deprivation">Material deprivation</h3>
<p>Material deprivation is measured using Afrobarometer’s lived poverty indicators, which capture how frequently respondents experienced shortages of basic necessities during the past year. These include shortages of food, clean water, medical care, cooking fuel, and cash income. Higher values indicate greater levels of material deprivation.</p>
</section>
<section id="neighborhood-infrastructure" class="level3">
<h3 class="anchored" data-anchor-id="neighborhood-infrastructure">Neighborhood infrastructure</h3>
<p>Neighborhood infrastructure conditions are proxied using enumerator-observed characteristics of respondents’ enumeration areas. These indicators capture access to basic services and facilities, as well as aspects of accessibility and road quality. Lower levels of service access and poorer infrastructure reflect more under-serviced neighborhood conditions.</p>
</section>
<section id="informal-support-networks" class="level3">
<h3 class="anchored" data-anchor-id="informal-support-networks">Informal support networks</h3>
<p>Reliance on informal support networks is measured using survey questions asking whether respondents received assistance during the past year from (i) family members and (ii) friends or neighbors. These variables capture the extent to which households rely on informal social ties to cope with economic or social difficulties.</p>
</section>
<section id="perceived-neighborhood-insecurity" class="level3">
<h3 class="anchored" data-anchor-id="perceived-neighborhood-insecurity">Perceived neighborhood insecurity</h3>
<p>Perceived insecurity is measured using respondents’ self-reported frequency of feeling unsafe in their home or neighborhood. Higher values indicate greater perceived insecurity.</p>
</section>
<section id="control-variables" class="level3">
<h3 class="anchored" data-anchor-id="control-variables">Control variables</h3>
<p>Descriptive analyses also consider basic sociodemographic characteristics, including age, gender, education level, region of residence, and urban–rural location.</p>
</section>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<p>This section presents descriptive statistics illustrating patterns of material deprivation, neighborhood conditions, reliance on informal support networks, and perceived insecurity among urban respondents. The objective is to document how these dimensions are distributed in the sample and how they relate to one another descriptively, without making causal claims.</p>
</section>
<section id="the-socio-demographic-profile" class="level2">
<h2 class="anchored" data-anchor-id="the-socio-demographic-profile">The socio-demographic profile</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Here, we are prepping the variables for the anlysis, by standerdizing them</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data_prep <span class="ot">&lt;-</span> Afro <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">as.numeric</span>(Q1),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(Q101),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(Q96),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">factor</span>(REGION)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_prep <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(URBRUR <span class="sc">==</span> <span class="st">"Urban"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Table 1 for descriptive stats of variables of interest</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_age   =</span> <span class="fu">sd</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_age    =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(age))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>gender_summary <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>education_summary <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(education, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>region_summary <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(region, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we are building a unified Table 1</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>age_row <span class="ot">&lt;-</span> age_summary <span class="sc">%&gt;%</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Mean (SD)"</span>,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(mean_age, <span class="dv">1</span>), <span class="st">" ("</span>, <span class="fu">round</span>(sd_age, <span class="dv">1</span>), <span class="st">")"</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>gender_rows <span class="ot">&lt;-</span> gender_summary <span class="sc">%&gt;%</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Gender"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">as.character</span>(gender),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(pct, <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>education_rows <span class="ot">&lt;-</span> education_summary <span class="sc">%&gt;%</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Education"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">as.character</span>(education),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(pct, <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>region_rows <span class="ot">&lt;-</span> region_summary <span class="sc">%&gt;%</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Region"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">as.character</span>(region),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(pct, <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>table1_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(age_row, gender_rows, education_rows, region_rows)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  table1_final,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 1. Sociodemographic characteristics of urban respondents"</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Category"</span>, <span class="st">"Value"</span>)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 1. Sociodemographic characteristics of urban respondents</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 81%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age (years)</td>
<td style="text-align: left;">Mean (SD)</td>
<td style="text-align: left;">39.2 (15.2)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gender</td>
<td style="text-align: left;">Man</td>
<td style="text-align: left;">403 (49.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gender</td>
<td style="text-align: left;">Woman</td>
<td style="text-align: left;">405 (50.1%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Informal schooling only (including Koranic schooling)</td>
<td style="text-align: left;">37 (4.6%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Intermediate school or Some secondary school / high school</td>
<td style="text-align: left;">84 (10.4%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">No formal schooling</td>
<td style="text-align: left;">46 (5.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Post-graduate</td>
<td style="text-align: left;">56 (6.9%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Post-secondary qualifications, other than university e.g.&nbsp;a diploma or degree from a polytechnic or college</td>
<td style="text-align: left;">108 (13.4%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Primary school completed</td>
<td style="text-align: left;">82 (10.1%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Secondary school / high school completed</td>
<td style="text-align: left;">110 (13.6%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Some primary schooling</td>
<td style="text-align: left;">76 (9.4%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">Some university</td>
<td style="text-align: left;">118 (14.6%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: left;">University completed</td>
<td style="text-align: left;">91 (11.3%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Béni Mellal-Khénifra</td>
<td style="text-align: left;">48 (5.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Drâa-Tafilalet</td>
<td style="text-align: left;">24 (3%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Ed Dakhla-Oued Ed Dahab</td>
<td style="text-align: left;">8 (1%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Fès-Meknès</td>
<td style="text-align: left;">104 (12.9%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Grand Casablanca-Settat</td>
<td style="text-align: left;">200 (24.8%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Guelmim-Oued Noun</td>
<td style="text-align: left;">8 (1%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Laâyoune-Sakia Al Hamra</td>
<td style="text-align: left;">16 (2%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Marrakech-Safi</td>
<td style="text-align: left;">72 (8.9%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Oriental</td>
<td style="text-align: left;">64 (7.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Rabat-Salé-Kénitra</td>
<td style="text-align: left;">128 (15.8%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Souss-Massa</td>
<td style="text-align: left;">56 (6.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: left;">Tanger-Tétouan-Al Hoceima</td>
<td style="text-align: left;">80 (9.9%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Table 1 summarizes the sociodemographic profile of the urban subsample (N = 808). Respondents have a mean age of 39.2 years (SD = 15.2), indicating substantial age heterogeneity. The gender distribution is nearly balanced (49.9% men, 50.1% women). Educational attainment is diverse: the largest categories are some university (14.6%), secondary/high school completed (13.6%), and post-secondary non-university qualifications (13.4%), while smaller shares report no formal schooling (5.7%) or post-graduate education (6.9%). Regionally, the sample is concentrated in Grand Casablanca–Settat (24.8%), followed by Rabat–Salé–Kénitra (15.8%) and Fès–Meknès (12.9%), reflecting the distribution of the urban population across major metropolitan areas.</p>
</section>
<section id="material-deprivation-1" class="level2">
<h2 class="anchored" data-anchor-id="material-deprivation-1">Material deprivation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Material deprivation items (Q7A–Q7E) </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#First, let's prepare the data</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#0=Never, 1=Once/twice, 2=Several, 3=Many, 4=Always, 9=Don't know</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>lp_score <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(x))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(x) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"don't know|dont know|refus|no answer"</span>) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"^never"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"once|twice"</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"several"</span>) <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"many"</span>) <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"always"</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>   <span class="co"># catches unexpected labels safely</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>dep_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Never"</span>, <span class="st">"Once or twice"</span>, <span class="st">"Several times"</span>, <span class="st">"Many"</span>, <span class="st">"Always"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_food  =</span> <span class="fu">lp_score</span>(Q7A),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_water =</span> <span class="fu">lp_score</span>(Q7B),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_med   =</span> <span class="fu">lp_score</span>(Q7C),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_fuel  =</span> <span class="fu">lp_score</span>(Q7D),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_cash  =</span> <span class="fu">lp_score</span>(Q7E),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_food_f  =</span> <span class="fu">factor</span>(dep_food,  <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> dep_levels, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_water_f =</span> <span class="fu">factor</span>(dep_water, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> dep_levels, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_med_f   =</span> <span class="fu">factor</span>(dep_med,   <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> dep_levels, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_fuel_f  =</span> <span class="fu">factor</span>(dep_fuel,  <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> dep_levels, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_cash_f  =</span> <span class="fu">factor</span>(dep_cash,  <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> dep_levels, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># index (mean across available items)</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">dep_index =</span> <span class="fu">rowMeans</span>(<span class="fu">cbind</span>(dep_food, dep_water, dep_med, dep_fuel, dep_cash), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a table for material deprivation</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>freq_n_pct_factor <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(x, <span class="at">useNA =</span> <span class="st">"no"</span>)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">names</span>(tab),</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(<span class="fu">as.integer</span>(tab), <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> tab <span class="sc">/</span> <span class="fu">sum</span>(tab), <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>dep_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_n_pct_factor</span>(data_urban<span class="sc">$</span>dep_food_f)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="st">"Gone without enough food (Q7A)"</span>),</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_n_pct_factor</span>(data_urban<span class="sc">$</span>dep_water_f) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="st">"Gone without clean water (Q7B)"</span>),</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_n_pct_factor</span>(data_urban<span class="sc">$</span>dep_med_f)   <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="st">"Gone without medical care (Q7C)"</span>),</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_n_pct_factor</span>(data_urban<span class="sc">$</span>dep_fuel_f)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="st">"Gone without cooking fuel (Q7D)"</span>),</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_n_pct_factor</span>(data_urban<span class="sc">$</span>dep_cash_f)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="st">"Gone without cash income (Q7E)"</span>)</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Category, Value)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>dep_index_row <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Material deprivation index (mean of Q7A–Q7E)"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Mean (SD)"</span>,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="fu">mean</span>(dep_index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                   <span class="st">" ("</span>, <span class="fu">round</span>(<span class="fu">sd</span>(dep_index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>), <span class="st">")"</span>)</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>dep_table_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dep_table, dep_index_row)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>  dep_table_final,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 2. Material deprivation (lived poverty indicators) among urban respondents"</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Category"</span>, <span class="st">"Value"</span>)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 2. Material deprivation (lived poverty indicators) among urban respondents</caption>
<colgroup>
<col style="width: 63%">
<col style="width: 19%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Gone without enough food (Q7A)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">707 (87.7%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without enough food (Q7A)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">62 (7.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without enough food (Q7A)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">31 (3.8%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without enough food (Q7A)</td>
<td style="text-align: left;">Many</td>
<td style="text-align: left;">6 (0.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without enough food (Q7A)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">0 (0%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without clean water (Q7B)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">635 (78.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without clean water (Q7B)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">100 (12.4%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without clean water (Q7B)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">54 (6.7%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without clean water (Q7B)</td>
<td style="text-align: left;">Many</td>
<td style="text-align: left;">15 (1.9%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without clean water (Q7B)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">1 (0.1%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without medical care (Q7C)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">469 (58.6%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without medical care (Q7C)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">163 (20.4%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without medical care (Q7C)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">140 (17.5%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without medical care (Q7C)</td>
<td style="text-align: left;">Many</td>
<td style="text-align: left;">22 (2.8%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without medical care (Q7C)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">6 (0.8%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without cooking fuel (Q7D)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">656 (81.3%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without cooking fuel (Q7D)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">94 (11.6%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without cooking fuel (Q7D)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">45 (5.6%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without cooking fuel (Q7D)</td>
<td style="text-align: left;">Many</td>
<td style="text-align: left;">10 (1.2%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without cooking fuel (Q7D)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">2 (0.2%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without cash income (Q7E)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">498 (62.4%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without cash income (Q7E)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">115 (14.4%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without cash income (Q7E)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">100 (12.5%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gone without cash income (Q7E)</td>
<td style="text-align: left;">Many</td>
<td style="text-align: left;">51 (6.4%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gone without cash income (Q7E)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">34 (4.3%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Material deprivation index (mean of Q7A–Q7E)</td>
<td style="text-align: left;">Mean (SD)</td>
<td style="text-align: left;">0.44 (0.61)</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_urban, <span class="fu">aes</span>(<span class="at">x =</span> dep_index)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of material deprivation among urban respondents"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Material deprivation index (mean of Q7A–Q7E)"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of respondents"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RESEARCH-REP-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Table 2 presents the distribution of lived poverty indicators among urban respondents. Most respondents report never experiencing shortages of basic necessities, particularly food (87.7%) and cooking fuel (81.3%). However, material vulnerability remains non-negligible: cash income deprivation is the most prevalent dimension, with 37.6% of respondents reporting having gone without cash income at least once in the past year, and 4.3% reporting persistent deprivation. Medical care also emerges as a salient constraint, as 41.4% report at least occasional difficulty accessing healthcare. The composite material deprivation index (mean = 0.44, SD = 0.61) indicates generally low but uneven exposure to material hardship within urban contexts.</p>
</section>
<section id="informal-support-networks-1" class="level2">
<h2 class="anchored" data-anchor-id="informal-support-networks-1">Informal support networks</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recoding from labels</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>yn_recode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(x))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(x) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"^yes"</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(x, <span class="st">"^no"</span>)  <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">support_family =</span> <span class="fu">yn_recode</span>(Q8A),  <span class="co"># relied on family</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">support_friends =</span> <span class="fu">yn_recode</span>(Q8B)  <span class="co"># relied on friends</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Building an informal support netwroks table</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>support_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  data_urban <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(support_family, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(support_family)) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="st">"Relied on family support (Q8A)"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> <span class="fu">ifelse</span>(support_family <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  data_urban <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(support_friends, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(support_friends)) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="st">"Relied on friends support (Q8B)"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">Category =</span> <span class="fu">ifelse</span>(support_friends <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Category, Value)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  support_table,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 3. Reliance on informal support networks among urban respondents"</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Category"</span>, <span class="st">"Value"</span>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 3. Reliance on informal support networks among urban respondents</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Relied on family support (Q8A)</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">561 (69.8%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Relied on family support (Q8A)</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">243 (30.2%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Relied on friends support (Q8B)</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">696 (86.1%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Relied on friends support (Q8B)</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">112 (13.9%)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Table 3 summarizes reliance on informal support networks among urban respondents. Nearly one-third (30.2%) report having relied on family support, while reliance on friends is less common (13.9%). This asymmetry suggests that informal support in urban Morocco is primarily family-centered, with non-kin networks playing a more limited role, providing an empirical basis for examining how material deprivation may increase dependence on close social ties.</p>
</section>
<section id="perceived-insecurity" class="level2">
<h2 class="anchored" data-anchor-id="perceived-insecurity">Perceived insecurity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Prepping the varibales of perceived insecurity</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">insecurity =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      Q9 <span class="sc">==</span> <span class="st">"Never"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      Q9 <span class="sc">==</span> <span class="st">"Just once or twice"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      Q9 <span class="sc">==</span> <span class="st">"Several times"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      Q9 <span class="sc">==</span> <span class="st">"Many times"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      Q9 <span class="sc">==</span> <span class="st">"Always"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">insecurity_f =</span> <span class="fu">factor</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      insecurity,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never"</span>, <span class="st">"Once or twice"</span>, <span class="st">"Several times"</span>, <span class="st">"Many times"</span>, <span class="st">"Always"</span>),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Table 4 for perceived insecurity</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>insec_table <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(insecurity_f, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Felt unsafe in home or neighborhood (Q9)"</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">as.character</span>(insecurity_f),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Category, Value)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  insec_table,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 4. Perceived insecurity among urban respondents"</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Category"</span>, <span class="st">"Value"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 4. Perceived insecurity among urban respondents</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Felt unsafe in home or neighborhood (Q9)</td>
<td style="text-align: left;">Never</td>
<td style="text-align: left;">520 (64.4%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Felt unsafe in home or neighborhood (Q9)</td>
<td style="text-align: left;">Once or twice</td>
<td style="text-align: left;">144 (17.8%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Felt unsafe in home or neighborhood (Q9)</td>
<td style="text-align: left;">Several times</td>
<td style="text-align: left;">118 (14.6%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Felt unsafe in home or neighborhood (Q9)</td>
<td style="text-align: left;">Many times</td>
<td style="text-align: left;">18 (2.2%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Felt unsafe in home or neighborhood (Q9)</td>
<td style="text-align: left;">Always</td>
<td style="text-align: left;">8 (1%)</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_urban, <span class="fu">aes</span>(<span class="at">x =</span> insecurity_f)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of perceived neighborhood insecurity"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Frequency of feeling unsafe"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of respondents"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RESEARCH-REP-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Table 4 reports perceived insecurity among urban respondents, measured as the frequency of having felt unsafe in one’s home or neighborhood over the past year. While a majority (64.4%) report never feeling unsafe, a sizeable minority (35.6%) report experiencing insecurity at least once, including 16.8% who report feeling unsafe several times or more. This dispersion suggests meaningful variation in perceived neighborhood safety across urban contexts, motivating the examination of how neighborhood infrastructure conditions relate to insecurity perceptions.</p>
</section>
<section id="neighborhood-infrastructure-1" class="level2">
<h2 class="anchored" data-anchor-id="neighborhood-infrastructure-1">Neighborhood infrastructure</h2>
<p>In Afrobarometer R10, neighborhood infrastructure is measured at the EA (Enumeration Area) level, not via perceptions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Neighborhood infrastructure (EA-level)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Services: Yes = 1, No = 0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_electricity =</span> <span class="fu">if_else</span>(EA_SVC_A <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_water       =</span> <span class="fu">if_else</span>(EA_SVC_B <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_sewage      =</span> <span class="fu">if_else</span>(EA_SVC_C <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Roads: any "Paved ..." = 1, otherwise 0</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_roads =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(EA_ROAD_A) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(EA_ROAD_A), <span class="st">"paved"</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simple infrastructure index (0–1)</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_index =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(infra_electricity, infra_water, infra_sewage, infra_roads),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We notice here that the current infrastructure measure has zero variance in the urban subsample. With zero variance, we can not use it in a model, we can’t test H2 with it, and a descriptive table would be pointless. We need to therefore find which EA variables vary, to use them as proxies for infrastructure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ea_vars <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"EA_"</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>var_check <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">names</span>(ea_vars),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_unique =</span> <span class="fu">sapply</span>(ea_vars, <span class="cf">function</span>(x) <span class="fu">n_distinct</span>(x)),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_values =</span> <span class="fu">sapply</span>(ea_vars, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(x), <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">3</span>, <span class="fu">length</span>(<span class="fu">unique</span>(x)))], <span class="at">collapse =</span> <span class="st">" | "</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_unique))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Now that we see which variables vary, we proceed: </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Road quality: ordinal → numeric (higher = better)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_quality =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      EA_ROAD_C <span class="sc">==</span> <span class="st">"Very good"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>      EA_ROAD_C <span class="sc">==</span> <span class="st">"Good"</span>      <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      EA_ROAD_C <span class="sc">==</span> <span class="st">"Fair"</span>      <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>      EA_ROAD_C <span class="sc">==</span> <span class="st">"Poor"</span>      <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Paved road (binary)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">paved_road =</span> <span class="fu">if_else</span>(</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(<span class="fu">str_to_lower</span>(EA_ROAD_A), <span class="st">"paved"</span>),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Facilities (binary presence)</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">fac_market =</span> <span class="fu">if_else</span>(EA_FAC_A <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">fac_school =</span> <span class="fu">if_else</span>(EA_FAC_C <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Security infrastructure (binary)</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec_post   =</span> <span class="fu">if_else</span>(EA_SEC_A <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="at">missing =</span> <span class="cn">NA_real_</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Building the infrastructure index: </span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>data_urban <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_index =</span> <span class="fu">rowMeans</span>(</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        road_quality,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        paved_road,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        fac_market,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        fac_school,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        sec_post</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: false</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_urban<span class="sc">$</span>infra_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.400   1.200   1.200   1.234   1.400   1.400 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_urban<span class="sc">$</span>infra_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RESEARCH-REP-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Doing a table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Road quality distribution </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>table5_road <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(road_quality)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(road_quality, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Road quality (EA_ROAD_C)"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      road_quality <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Very good"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      road_quality <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Good"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      road_quality <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Fair"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      road_quality <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Poor"</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Variable, Category, Value)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Index summary row </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>table5_index <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="st">"Neighborhood infrastructure index"</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> <span class="st">"Mean (SD)"</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">paste0</span>(</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">mean</span>(infra_index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">" ("</span>, <span class="fu">round</span>(<span class="fu">sd</span>(infra_index, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>), <span class="st">")"</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>table5 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(table5_road, table5_index)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  table5,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 5. Neighborhood infrastructure conditions among urban respondents"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Category"</span>, <span class="st">"Value"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Table 5. Neighborhood infrastructure conditions among urban respondents</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Road quality (EA_ROAD_C)</td>
<td style="text-align: left;">Poor</td>
<td style="text-align: left;">16 (2%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Road quality (EA_ROAD_C)</td>
<td style="text-align: left;">Fair</td>
<td style="text-align: left;">72 (8.9%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Road quality (EA_ROAD_C)</td>
<td style="text-align: left;">Good</td>
<td style="text-align: left;">192 (23.8%)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Road quality (EA_ROAD_C)</td>
<td style="text-align: left;">Very good</td>
<td style="text-align: left;">528 (65.3%)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neighborhood infrastructure index</td>
<td style="text-align: left;">Mean (SD)</td>
<td style="text-align: left;">1.23 (0.22)</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>road_plot <span class="ot">&lt;-</span> data_urban <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(road_quality)) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_quality_f =</span> <span class="fu">factor</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>      road_quality,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Poor"</span>, <span class="st">"Fair"</span>, <span class="st">"Good"</span>, <span class="st">"Very good"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(road_plot, <span class="fu">aes</span>(<span class="at">x =</span> road_quality_f)) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Road quality in enumeration areas (urban respondents)"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Road quality (EA_ROAD_C)"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of respondents"</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RESEARCH-REP-1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Table 5 highlights substantial variation in neighborhood infrastructure quality among urban respondents. While a majority reside in areas with good or very good road conditions (approximately 89%), a non-negligible share of respondents live in neighborhoods with fair or poor road quality. The neighborhood infrastructure index reflects this heterogeneity, with an average value of 1.23 (SD = 0.22), indicating meaningful differences in local infrastructure conditions across urban enumeration areas. This variation provides a relevant contextual measure for examining perceptions of neighborhood insecurity.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion:</h1>
<p>This study set out to explore how material deprivation and neighborhood infrastructure conditions relate to reliance on informal support networks and perceptions of insecurity in urban Morocco. The descriptive evidence provides partial but informative support for both hypotheses, while also highlighting important limitations related to measurement and scope.</p>
<p>First, the results are broadly consistent with H1, which posits a relationship between material deprivation and reliance on informal support. Although most urban respondents report low levels of lived poverty, a substantial minority experience recurring shortages, particularly with respect to cash income and access to medical care. At the same time, nearly one-third of respondents report relying on family support, whereas reliance on friends or neighbors is much less common. This pattern suggests that informal support networks in urban Morocco are primarily family-centered, rather than broadly community-based. While the descriptive statistics alone do not establish a direct link between deprivation and support, the coexistence of material vulnerability and reliance on family assistance makes H1 empirically plausible and worth examining further in bivariate or multivariate analysis.</p>
<p>Second, the descriptive findings also lend cautious support to H2, concerning neighborhood infrastructure and perceived insecurity. Although a majority of respondents report never feeling unsafe, more than one-third experience insecurity at least occasionally, indicating meaningful variation in perceived neighborhood safety within urban areas. At the same time, the analysis reveals that basic infrastructure services such as electricity and water are nearly universal in the urban subsample, limiting their usefulness as explanatory factors. Consequently, neighborhood infrastructure had to be operationalized using locally varying enumeration-area indicators, most notably road quality, facilities, and security-related infrastructure. Variation in road quality, in particular, suggests that infrastructure inequalities persist even within cities and may plausibly shape feelings of safety and exposure to risk.</p>
<p>However, the descriptive analysis also underscores important measurement limitations. Neighborhood infrastructure is a multidimensional concept that cannot be fully captured by road quality or the presence of selected facilities alone. Factors such as housing quality, lighting, informal settlements, population density, or policing practices may be central to perceptions of insecurity. As such, the infrastructure index used here should be interpreted as a proxy for broader neighborhood conditions rather than a comprehensive measure. This limitation calls for caution when interpreting any observed association between infrastructure and insecurity and highlights the need to frame results as contextual correlations rather than causal effects.</p>
<p>This being said, the descriptive statistics suggest that both hypotheses are empirically grounded but not deterministically supported. Material deprivation and infrastructure conditions exhibit sufficient variation in urban Morocco to justify further analysis, yet the observed patterns also emphasize the complexity of urban vulnerability and the limits of available survey-based proxies. Subsequent analyses should therefore be interpreted as exploratory, shedding light on associations rather than definitive mechanisms.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>